'use strict';

var s=function(){return s=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);}return e},s.apply(this,arguments)};function h(t){return t.toLowerCase()}var C=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],O=/[^A-Z0-9]+/gi;function _(t,e){e===void 0&&(e={});for(var n=e.splitRegexp,r=n===void 0?C:n,i=e.stripRegexp,o=i===void 0?O:i,a=e.transform,l=a===void 0?h:a,f=e.delimiter,c=f===void 0?" ":f,p=b(b(t,r,"$1\0$2"),o,"\0"),d=0,y=p.length;p.charAt(d)==="\0";)d++;for(;p.charAt(y-1)==="\0";)y--;return p.slice(d,y).split("\0").map(l).join(c)}function b(t,e,n){return e instanceof RegExp?t.replace(e,n):e.reduce(function(r,i){return r.replace(i,n)},t)}function m(t,e){var n=t.charAt(0),r=t.substr(1).toLowerCase();return e>0&&n>="0"&&n<="9"?"_"+n+r:""+n.toUpperCase()+r}function x(t,e){return e===void 0&&(e={}),_(t,s({delimiter:"",transform:m},e))}function P(t,e){return e===0?t.toLowerCase():m(t,e)}function g(t,e){return e===void 0&&(e={}),x(t,s({transform:P},e))}var T=(t,e,n)=>{let r=e.length-1;for(let i=0;i<r;++i){let o=g(e[i]);o in t||(t[o]={}),t=t[o];}t[g(e[r])]=n;},u=(t,e)=>t===void 0?e:t,v=(t,e,n=" ".repeat(4))=>e!=="all"?t:n+t,w=(t,e)=>t.replace(/"(\\[^]|[^\\"])*"\s*:?/g,r=>/[0-9]/.test(r)&&/[a-zA-Z]/.test(r)?r:/:$/.test(r)?v(r.replace(/^"|"(?=\s*:$)/g,""),e):r).replace(/}/g,r=>v(r,e));var j=(t,e,n)=>{let r=t.reduce((o,a)=>{if(a.attributes===void 0)throw new Error(`Token ${a.name} has no attributes`);return (a.attributes.category===e||e==="all")&&(n?o[a.path.join(".")]=`var(--${a.name})`:o[a.path.join(".")]=a.value),o},{}),i={};return Object.keys(r).forEach(o=>{let a=o.split(".").filter(l=>l!==e);T(i,a,r[o]);}),JSON.stringify(i,null,2)},S=({dictionary:{allTokens:t},type:e,isVariables:n,tailwind:r})=>{let i=j(t,e,n);if(e==="all"){let o=u(r?.darkMode,"class"),a=u(Array.isArray(r?.content)?r?.content.map(c=>`"${c}"`):r?.content,['"./src/**/*.{ts,tsx}"']),l=u(r?.plugins?.map(c=>`require("@tailwindcss/${c}")`),[]),f=`/** @type {import('tailwindcss').Config} */
module.exports = {
  mode: "jit",
  content: [${a}],
  darkMode: "${o}",
  theme: {
    extend: ${w(i,e)},
  },`;return l.length>0&&(f+=`
  plugins: [${l}]`),f+=`
}`,f}else return `module.exports = ${w(i)}`},Z=({type:t,isVariables:e=!1,source:n,transforms:r,buildPath:i,tailwind:o})=>{if(t===void 0)throw new Error("type is required");return {source:u(n,["tokens/**/*.json"]),format:{tailwindFormat:({dictionary:a})=>S({dictionary:a,isVariables:e,type:t,tailwind:o})},platforms:{[t!=="all"?`tailwind/${t}`:"tailwind"]:{transforms:u(r,["attribute/cti","name/cti/kebab"]),buildPath:u(i,"build/web/"),files:[{destination:t!=="all"?`${t}.tailwind.cjs`:"tailwind.config.cjs",format:"tailwindFormat"}]}}}};

exports.makeSdTailwindConfig = Z;
